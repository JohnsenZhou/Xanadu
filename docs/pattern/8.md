# 模板方法模式

## 定义

模板方法模式由两部分组成，第一部分是抽象父类，第二部分是具体实现的子类。

通常在抽象父类中定义了一个算法的框架，包括实现一些公共方法以及封装子类中所有方法的执行顺序。子类通过继承这个抽象类，也继承了整个算法框架，并且可以重写父类的方法。

## 真实世界类比

模板方法可用于建造大量房屋。标准房屋建造方案中可提供几个扩展点，允许潜在房屋业主调整成品房屋的部分细节。

<ImageDesc imgWidth="80%" src="https://refactoringguru.cn/images/patterns/diagrams/template-method/live-example-2x.png" desc="可对典型的建筑方案进行微调以更好地满足客户需求。" />

每个建造步骤（例如打地基、建造框架、建造墙壁和安装水电管线等）都能进行微调，这使得成品房屋会略有不同。

## 模式实现-Coffee or Tea

这里我们用一个经典的例子**咖啡与茶**来讲解模板方法模式。

### 泡一杯咖啡

首先我们列一下泡咖啡的通用步骤：

1. 把水煮沸
2. 用沸水冲泡咖啡
3. 把咖啡倒进杯子
4. 加糖和牛奶

转换成具体代码如下：

```js
class Coffee {
  boilWater() {
    console.log("把水煮沸");
  }
  brewCoffeeGriends() {
    console.log("用沸水冲泡咖啡");
  }
  pourInCup() {
    console.log("把咖啡倒进杯子");
  }
  addSugarAndMilk() {
    console.log("加糖和牛奶");
  }
  init() {
    this.boilWater();
    this.brewCoffeeGriends();
    this.pourInCup();
    this.addSugarAndMilk();
  }
}

const coffee = new Coffee();
coffee.init();
```

### 泡一壶茶

然后我们再列一下泡茶的通用步骤：

1. 把水煮沸
2. 用沸水浸泡茶叶
3. 把茶水倒进杯子
4. 加柠檬

转换成具体代码如下：

```js
class Tea {
  boilWater() {
    console.log("把水煮沸");
  }
  steepTeaBag() {
    console.log("用沸水浸泡茶叶");
  }
  pourInCup() {
    console.log("把茶水倒进杯子");
  }
  addLemon() {
    console.log("加柠檬");
  }
  init() {
    this.boilWater();
    this.steepTeaBag();
    this.pourInCup();
    this.addLemon();
  }
}

const tea = new Tea();
tea.init();
```

### 分离共同点

通过上面的两组比较，我们可以很明显的发现咖啡和茶的冲泡过程是大致相同的。

| 泡咖啡         | 泡茶           |
| -------------- | -------------- |
| 把水煮沸       | 把水煮沸       |
| 用沸水冲泡咖啡 | 用沸水浸泡茶叶 |
| 把咖啡倒进杯子 | 把茶水倒进杯子 |
| 加糖和牛奶     | 加柠檬         |

对比一下两者的不同点：

- 原料不同。一个是咖啡一个是茶，但都可以抽象为**饮料**。
- 泡的方式不同。咖啡是冲泡，茶是浸泡，但都可以抽象为**泡**。
- 加入的调料不同。一个是糖和牛奶，另一个是柠檬，但都可以抽象为**调料**。

经过抽象之后，不管是泡茶还是泡咖啡我们都可以整理为以下四步：

1. 把水煮沸
2. 用沸水冲泡饮料
3. 把饮料倒进杯子
4. 加调料

让我们忘记最开始创建的 Coffee 和 Tea 类。现在可以创建一个抽象父类来表示泡一杯饮料的过程。

```js
```
